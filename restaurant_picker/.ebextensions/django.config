container_commands:
  01_migrate:
    command: "source /var/app/venv/*/bin/activate && python3 manage.py migrate"
    leader_only: true
option_settings:
  aws:ec2:instances:
    SpotFleetOnDemandAboveBasePercentage: '0'
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: restaurant_picker.settings
  aws:elasticbeanstalk:container:python:
    WSGIPath: restaurant_picker.wsgi:application
  aws:autoscaling:launchconfiguration:
    IamInstanceProfile: restaurant-picker-ec2-role
  aws:elasticbeanstalk:environment:
    ServiceRole: aws-elasticbeanstalk-service-role
    EnvironmentType: SingleInstance
    LoadBalancerType: application
  aws:elasticbeanstalk:healthreporting:system:
    ConfigDocument:
      Version: 1
      CloudWatchMetrics:
        Instance: {}
        Environment: {}
      Rules:
        Environment:
          ELB:
            ELBRequests4xx:
              Enabled: true
          Application:
            ApplicationRequests4xx:
              Enabled: true
    SystemType: basic
commands:
  install_postgres_driver:
    command: "yum install -y postgresql-devel"
